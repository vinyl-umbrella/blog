---
import { getContents, getTags } from '../utils/util';

const allPosts = await getContents();
const tags = getTags(allPosts);

interface Props {
  classname?: string;
}

const { classname } = Astro.props;
---

<div class:list={['tags', classname]}>
  <h3>Tags</h3>
  {
    [...tags.keys()].map((tag) => (
      <a href={`/tags/${tag}/`} class='tag'>
        <span>
          #&nbsp;{tag} <span class='tagcount'>({tags.get(tag)})</span>
        </span>
      </a>
    ))
  }
</div>

<style>
  .tags {
    top: 100px;
    display: block;
    padding: 0.5em;
    overflow-y: scroll;
    background-color: rgb(var(--gray-1));
    border: rgb(var(--white-3)) 1px solid;
    border-radius: 0.5em;

    h3 {
      margin-top: 0;
    }

    .tag {
      text-decoration: none;
      font-size: smaller;
      padding: 0.25em 0.5em;
      margin: 0.25em;
      color: rgb(var(--white-3));
      background-color: rgb(var(--gray-3));
      border-radius: 0.25em;

      &:hover {
        color: var(--accent);
        text-decoration: underline;
      }

      .tagcount {
        font-size: smaller;
      }
    }
  }

  .side {
    width: 16em;
    position: sticky;
    height: 300px;
    max-height: 30%;
    @media (max-width: 768px) {
      /* mobile */
      display: none;
    }
  }

  .bottom {
    display: none;
    @media (max-width: 768px) {
      /* mobile */
      margin-top: 1em;
    }
  }
</style>
